<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-10-29 Wed 22:01 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LKMP Getting Started</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="https://albus-droid.github.io/portfolio/templates/style.css"/>
<script src="https://albus-droid.github.io/portfolio/templates/typewriter-name.js" defer></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css"><script src="https://albus-droid.github.io/portfolio/templates/highlight-code.js" defer></script>
</head>
<body>
<div id="preamble" class="status">
<h1 id="name-typewriter"></h1>
<div class="container">
    <div class="social-links">
        <a href="https://github.com/albus-droid" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297 24 5.67 18.627.297 12 .297z"/></svg>
        </a>
        <a href="https://linkedin.com/in/albin-babu-varghese" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.225 0z"/></svg>
        </a>
        <a href="mailto:albinbabuvarghese@gmail.com" aria-label="Email">
        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Email</title><path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.75L12 16.625l-6.545-4.875v9.25H1.636C.732 21 .001 20.269.001 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.908 1.528-1.145C21.69 3.28 24 4.435 24 5.457z"/></svg>
        </a>
    </div>
    <div style="display: flex; align-items: center; gap: 1rem;">
        <a href="/" class="nav-link">[HOME]</a>
        <a href="resume.html" class="nav-link">[RESUME]</a>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
document.querySelectorAll('pre[class*="src-"]').forEach(pre => {
  const match = pre.className.match(/src-(\w+)/);
  if (match) {
    const lang = match[1];
    let code = pre.querySelector('code');
    if (!code) {
      code = document.createElement('code');
      code.textContent = pre.textContent;
      pre.textContent = '';
      pre.appendChild(code);
    }
    code.className = `language-${lang}`;
  }
});
hljs.highlightAll();
</script>
</div>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org07e7cd8">1. Baby Steps</a></li>
<li><a href="#org9d5204c">2. Debugging Tools</a>
<ul>
<li><a href="#orgd17e13e">2.1. Core Debugging</a></li>
<li><a href="#orgf1cb689">2.2. Tracing</a></li>
<li><a href="#org12f82ef">2.3. Detectors</a></li>
<li><a href="#orgfb9a8e6">2.4. Sanitizers</a></li>
<li><a href="#org3eedc4a">2.5. Post-Mortem</a></li>
<li><a href="#orgef2afdb">2.6. Logging</a></li>
</ul>
</li>
<li><a href="#orgff0342a">3. Required Config</a></li>
<li><a href="#org55ae0c6">4. Next Steps</a></li>
<li><a href="#org5a525d6">5. Links</a></li>
</ul>
</div>
</div>
<p>
I was selected for LKMP Fall 2025! This is where I&rsquo;ll document the debugging tools and workflow I&rsquo;m learning. Will update as I go.
</p>
<div id="outline-container-org07e7cd8" class="outline-2">
<h2 id="org07e7cd8"><span class="section-number-2">1.</span> Baby Steps</h2>
<div class="outline-text-2" id="text-1">
<p>
My goal: Find and fix a syzbot bug. Any subsystem, just want to get started.
</p>

<p>
From the mentorship videos, here&rsquo;s the basic process:
</p>

<ol class="org-ol">
<li>Build kernel with <code>CONFIG_DEBUG_INFO=y</code> <code>CONFIG_FRAME_POINTER=y</code></li>
<li>Boot QEMU with <code>-s -S</code> and <code>nokaslr ftrace_dump_on_oops</code></li>
<li>Attach GDB: <code>gdb vmlinux</code>, <code>target remote :1234</code>, set breakpoints</li>
<li>Trace with <code>trace-cmd record</code> then <code>trace-cmd report</code></li>
<li>Check scheduling: <code>perf sched record</code>, <code>perf sched latency sort max</code></li>
<li>Enable watchdogs &amp; hung task detectors</li>
<li>Add <code>trace_printk()</code> in suspected code paths</li>
<li>For crashes: use kdump + crash tool</li>
</ol>

<p>
Starting with GDB first.
</p>
</div>
</div>
<div id="outline-container-org9d5204c" class="outline-2">
<h2 id="org9d5204c"><span class="section-number-2">2.</span> Debugging Tools</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgd17e13e" class="outline-3">
<h3 id="orgd17e13e"><span class="section-number-3">2.1.</span> Core Debugging</h3>
<div class="outline-text-3" id="text-2-1">
<p>
QEMU - Run custom kernels safely
</p>

<div class="org-src-container">
<pre class="src src-bash">qemu-system-x86_64 -kernel bzImage -append "console=ttyS0 root=/dev/sda nokaslr" -s -S -nographic
</pre>
</div>

<p>
<code>-s -S</code> means GDB server on port 1234, wait for attach
</p>

<p>
GDB - Debug kernel in QEMU
Common commands: <code>target remote :1234</code>, <code>bt</code>, <code>info threads</code>, <code>b panic</code>, <code>list</code>
</p>

<p>
KGDB - GDB for real hardware (serial/network)
</p>

<p>
JTAG - For early boot problems
</p>
</div>
</div>
<div id="outline-container-orgf1cb689" class="outline-3">
<h3 id="orgf1cb689"><span class="section-number-3">2.2.</span> Tracing</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Ftrace - Built-in kernel tracer
Boot params: <code>ftrace_dump_on_oops</code>, <code>traceoff_on_warning</code>, <code>panic_on_warn=1</code>
</p>

<p>
trace-cmd - Ftrace frontend
</p>

<div class="org-src-container">
<pre class="src src-bash">trace-cmd record -p function_graph -g kfree
trace-cmd report
</pre>
</div>

<p>
perf - Scheduler analysis
</p>

<div class="org-src-container">
<pre class="src src-bash">perf sched record -- sleep 10
perf sched latency sort max
perf script
</pre>
</div>
</div>
</div>
<div id="outline-container-org12f82ef" class="outline-3">
<h3 id="org12f82ef"><span class="section-number-3">2.3.</span> Detectors</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Lockup Watchdogs - Catch hung CPUs
Use: <code>nmi_watchdog=1 watchdog_thresh=2</code>
</p>

<p>
Hung Task Detector - Find stuck processes
Use: <code>echo 10 &gt; /proc/sys/kernel/hung_task_timeout_secs</code>
</p>

<p>
RCU Stall Detector - RCU problems
Use: <code>rcupdate.rcu_cpu_stall_timeout=20</code>
</p>
</div>
</div>
<div id="outline-container-orgfb9a8e6" class="outline-3">
<h3 id="orgfb9a8e6"><span class="section-number-3">2.4.</span> Sanitizers</h3>
<div class="outline-text-3" id="text-2-4">
<p>
KASAN - memory bugs (use-after-free, out-of-bounds)
KCSAN - data races
LOCKDEP - locking bugs
</p>
</div>
</div>
<div id="outline-container-org3eedc4a" class="outline-3">
<h3 id="org3eedc4a"><span class="section-number-3">2.5.</span> Post-Mortem</h3>
<div class="outline-text-3" id="text-2-5">
<p>
kdump/crash - Capture and analyze kernel crashes
</p>

<p>
SysRq - Emergency debugging keys
</p>
</div>
</div>
<div id="outline-container-orgef2afdb" class="outline-3">
<h3 id="orgef2afdb"><span class="section-number-3">2.6.</span> Logging</h3>
<div class="outline-text-3" id="text-2-6">
<p>
printk:
</p>

<div class="org-src-container">
<pre class="src src-c">printk(KERN_DEBUG "value=%d\n", value);
</pre>
</div>

<p>
trace<sub>printk</sub> (lower overhead):
</p>

<div class="org-src-container">
<pre class="src src-c">trace_printk("value=%d\n", value);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgff0342a" class="outline-2">
<h2 id="orgff0342a"><span class="section-number-2">3.</span> Required Config</h2>
<div class="outline-text-2" id="text-3">
<p>
Kernel:
</p>
<ul class="org-ul">
<li><code>CONFIG_DEBUG_INFO=y</code></li>
<li><code>CONFIG_FRAME_POINTER=y</code></li>
<li><code>CONFIG_GDB_SCRIPTS=y</code></li>
</ul>

<p>
Boot params:
</p>
<ul class="org-ul">
<li><code>nokaslr</code></li>
<li><code>panic_on_warn=1</code></li>
<li><code>traceoff_on_warning</code></li>
<li><code>ftrace_dump_on_oops</code></li>
</ul>
</div>
</div>
<div id="outline-container-org55ae0c6" class="outline-2">
<h2 id="org55ae0c6"><span class="section-number-2">4.</span> Next Steps</h2>
<div class="outline-text-2" id="text-4">
<p>
Setup QEMU environment
Build debug kernel
Pick first syzbot bug
Document the fix
Submit patch
</p>
</div>
</div>
<div id="outline-container-org5a525d6" class="outline-2">
<h2 id="org5a525d6"><span class="section-number-2">5.</span> Links</h2>
<div class="outline-text-2" id="text-5">
<p>
<a href="https://docs.kernel.org/dev-tools/">https://docs.kernel.org/dev-tools/</a>
<a href="https://syzkaller.appspot.com/">https://syzkaller.appspot.com/</a>
<a href="https://kernelnewbies.org/">https://kernelnewbies.org/</a></p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2025-10-29 Wed 22:01</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
