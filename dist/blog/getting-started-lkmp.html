<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-10-29 Wed 21:35 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LKMP Getting Started</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="https://albus-droid.github.io/portfolio/templates/style.css"/>
<script src="https://albus-droid.github.io/portfolio/templates/typewriter-name.js" defer></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css"><script src="https://albus-droid.github.io/portfolio/templates/highlight-code.js" defer></script>
</head>
<body>
<div id="preamble" class="status">
<h1 id="name-typewriter"></h1>
<div class="container">
    <div class="social-links">
        <a href="https://github.com/albus-droid" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
            <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297 24 5.67 18.627.297 12 .297z"/></svg>
        </a>
        <a href="https://linkedin.com/in/albin-babu-varghese" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.225 0z"/></svg>
        </a>
        <a href="mailto:albinbabuvarghese@gmail.com" aria-label="Email">
        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Email</title><path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.75L12 16.625l-6.545-4.875v9.25H1.636C.732 21 .001 20.269.001 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.908 1.528-1.145C21.69 3.28 24 4.435 24 5.457z"/></svg>
        </a>
    </div>
    <div style="display: flex; align-items: center; gap: 1rem;">
        <a href="/" class="nav-link">[HOME]</a>
        <a href="resume.html" class="nav-link">[RESUME]</a>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
document.querySelectorAll('pre[class*="src-"]').forEach(pre => {
  const match = pre.className.match(/src-(\w+)/);
  if (match) {
    const lang = match[1];
    let code = pre.querySelector('code');
    if (!code) {
      code = document.createElement('code');
      code.textContent = pre.textContent;
      pre.textContent = '';
      pre.appendChild(code);
    }
    code.className = `language-${lang}`;
  }
});
hljs.highlightAll();
</script>
</div>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org2173725">1. Baby Steps</a>
<ul>
<li><a href="#org7946435">1.1. Typical Workflow</a></li>
</ul>
</li>
<li><a href="#orge84b747">2. Tools for Linux Kernel Bug Fixing</a>
<ul>
<li><a href="#orgc97d0b4">2.1. 1. Core Runtime Debugging</a>
<ul>
<li><a href="#orga640a81">2.1.1. QEMU</a></li>
<li><a href="#org3e08784">2.1.2. GDB</a></li>
<li><a href="#org84560ca">2.1.3. KGDB</a></li>
</ul>
</li>
<li><a href="#org348de3d">2.2. 2. Tracing &amp; Timing</a>
<ul>
<li><a href="#org98a5cb1">2.2.1. Ftrace</a></li>
<li><a href="#orge356211">2.2.2. trace-cmd</a></li>
<li><a href="#orgd5efe70">2.2.3. perf</a></li>
</ul>
</li>
<li><a href="#orgd5d6ab0">2.3. 3. Hang &amp; Stall Detectors</a></li>
<li><a href="#orgc6feca8">2.4. 4. Sanitizers &amp; Checkers</a></li>
<li><a href="#org0a6f9f0">2.5. 5. Post-Mortem Debugging</a></li>
<li><a href="#orgedf91e5">2.6. 6. Logging</a></li>
</ul>
</li>
<li><a href="#orgc1e6900">3. Essential Config</a></li>
</ul>
</div>
</div>
<p>
It is with great happiness I&rsquo;m sharing that I was selected for the LKMP Fall 2025 and this is where I document the tools I&rsquo;ll be using for bug fixing. I&rsquo;ll update this as I learn.
</p>
<div id="outline-container-org2173725" class="outline-2">
<h2 id="org2173725"><span class="section-number-2">1.</span> Baby Steps</h2>
<div class="outline-text-2" id="text-1">
<p>
My first plan is to find a bug reported by syzbot and fix it. I just want to get my feet wet.
</p>
</div>
<div id="outline-container-org7946435" class="outline-3">
<h3 id="org7946435"><span class="section-number-3">1.1.</span> Typical Workflow</h3>
<div class="outline-text-3" id="text-1-1">
<ol class="org-ol">
<li>Build kernel with <code>CONFIG_DEBUG_INFO=y</code> <code>CONFIG_FRAME_POINTER=y</code></li>
<li>Boot QEMU with <code>-s -S</code> and <code>nokaslr ftrace_dump_on_oops</code></li>
<li>Attach GDB: <code>gdb vmlinux</code>, <code>target remote :1234</code></li>
<li>Trace: <code>trace-cmd record ...</code> â†’ <code>trace-cmd report</code></li>
<li>Measure scheduling: <code>perf sched record</code>, <code>perf sched latency sort max</code></li>
<li>Enable watchdogs &amp; hung task detectors</li>
<li>Sprinkle <code>trace_printk()</code> in suspected paths</li>
<li>For production: configure kdump, analyze dumps with crash</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orge84b747" class="outline-2">
<h2 id="orge84b747"><span class="section-number-2">2.</span> Tools for Linux Kernel Bug Fixing</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgc97d0b4" class="outline-3">
<h3 id="orgc97d0b4"><span class="section-number-3">2.1.</span> 1. Core Runtime Debugging</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-orga640a81" class="outline-4">
<h4 id="orga640a81"><span class="section-number-4">2.1.1.</span> QEMU</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
Virtual machine emulator for running custom kernels.
</p>

<div class="org-src-container">
<pre class="src src-bash">qemu-system-x86_64 -kernel bzImage -append "console=ttyS0 root=/dev/sda nokaslr" -s -S -nographic
</pre>
</div>
</div>
</div>
<div id="outline-container-org3e08784" class="outline-4">
<h4 id="org3e08784"><span class="section-number-4">2.1.2.</span> GDB</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
Commands: <code>target remote :1234</code>, <code>bt</code>, <code>info threads</code>, <code>b panic</code>, <code>list</code>
</p>
</div>
</div>
<div id="outline-container-org84560ca" class="outline-4">
<h4 id="org84560ca"><span class="section-number-4">2.1.3.</span> KGDB</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
Attach GDB to real hardware via serial/net.
</p>
</div>
</div>
</div>
<div id="outline-container-org348de3d" class="outline-3">
<h3 id="org348de3d"><span class="section-number-3">2.2.</span> 2. Tracing &amp; Timing</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org98a5cb1" class="outline-4">
<h4 id="org98a5cb1"><span class="section-number-4">2.2.1.</span> Ftrace</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Built-in tracer. Useful params: <code>ftrace_dump_on_oops</code>, <code>traceoff_on_warning</code>, <code>panic_on_warn=1</code>
</p>
</div>
</div>
<div id="outline-container-orge356211" class="outline-4">
<h4 id="orge356211"><span class="section-number-4">2.2.2.</span> trace-cmd</h4>
<div class="outline-text-4" id="text-2-2-2">
<div class="org-src-container">
<pre class="src src-bash">trace-cmd record -p function_graph -g kfree
trace-cmd report
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd5efe70" class="outline-4">
<h4 id="orgd5efe70"><span class="section-number-4">2.2.3.</span> perf</h4>
<div class="outline-text-4" id="text-2-2-3">
<div class="org-src-container">
<pre class="src src-bash">perf sched record -- sleep 10
perf sched latency sort max
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd5d6ab0" class="outline-3">
<h3 id="orgd5d6ab0"><span class="section-number-3">2.3.</span> 3. Hang &amp; Stall Detectors</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>Hard/Soft Lockup Watchdogs</li>
<li>Hung Task Detector</li>
<li>RCU Stall Detector</li>
</ul>
</div>
</div>
<div id="outline-container-orgc6feca8" class="outline-3">
<h3 id="orgc6feca8"><span class="section-number-3">2.4.</span> 4. Sanitizers &amp; Checkers</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li>KASAN: memory bugs</li>
<li>KCSAN: data races</li>
<li>LOCKDEP: locking correctness</li>
</ul>
</div>
</div>
<div id="outline-container-org0a6f9f0" class="outline-3">
<h3 id="org0a6f9f0"><span class="section-number-3">2.5.</span> 5. Post-Mortem Debugging</h3>
<div class="outline-text-3" id="text-2-5">
<ul class="org-ul">
<li>kdump/kexec + crash</li>
<li>SysRq magic keys</li>
</ul>
</div>
</div>
<div id="outline-container-orgedf91e5" class="outline-3">
<h3 id="orgedf91e5"><span class="section-number-3">2.6.</span> 6. Logging</h3>
<div class="outline-text-3" id="text-2-6">
<ul class="org-ul">
<li><code>printk</code>: traditional logging</li>
<li><code>trace_printk</code>: writes to ftrace buffer (faster)</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc1e6900" class="outline-2">
<h2 id="orgc1e6900"><span class="section-number-2">3.</span> Essential Config</h2>
<div class="outline-text-2" id="text-3">
<p>
Kernel configs:
</p>
<ul class="org-ul">
<li><code>CONFIG_DEBUG_INFO=y</code></li>
<li><code>CONFIG_FRAME_POINTER=y</code></li>
<li><code>CONFIG_GDB_SCRIPTS=y</code></li>
</ul>

<p>
Boot params:
</p>
<ul class="org-ul">
<li><code>nokaslr</code></li>
<li><code>panic_on_warn=1</code></li>
<li><code>ftrace_dump_on_oops</code></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2025-10-29 Wed 21:35</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
